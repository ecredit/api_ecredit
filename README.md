# Партнерское API eCredit

## Общие положения
1. Все методы вызываются с помощь запросов `POST`
1. Рекомендуемый формат запроса `application/json`
1. Ответ всегда имеет формат `JSON`

## Точки доступа
`https://bankbus.ru/b2b/api/v1.2` - боевая точка доступа

`http://auto.bankbus.ru/b2b/api/v1.2` - точка доступа тестового контура. По умолчанию запросы будут идти на среду https://test2-auto.e-credit.one


## Версионирование
В настоящее время используется версия v1.2, которая указывается в URL

## Формат вызова

Формат запроса содержит ряд параметров, которые можно разделить на две группы: авторизационные параметры (шапка запроса) и полезная нагрузка метода (тело запроса). Шапка запроса у всех методов имеет один и тот же набор параметров. А тело запроса зависит от используемого метода.

### Шапка запроса

Имя | Описание
--- | ---
method | Имя метода
user_id | ID пользователя
user_flag | Тип нумерации пользоваеля
client_id | ID дилера
signature | Авторизационная подпись

Каждый запрос выполняется в связке дилер (client_id) + пользователь (user_id), который имеет доступ к указанному дилеру. При этом user_id пользователя может быть задан по нумерации еКредит (в этом случае параметр user_flag=0 или не задан) или по нумерации дилера (user_flag=1)

Параметр signature высчитывается как "соль" от передаваемый данных, подписанная секретным ключом и вычисляется по такому алгоритму:

```
`$signature = base64_encode(hash_hmac("sha1", json_encode($params), "xxxxxx", $raw_output = true))
```
где: 

$params - тело запроса, полезная нагрузка от каждого конкретного метода

xxxxxx - секретный ключ
